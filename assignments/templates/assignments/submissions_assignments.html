{% extends 'base.html' %}
{% block title %}Assignment Submissions{% endblock %}
{% block content %}
<div class="container mt-5">
  <h2 class="text-primary">ğŸ“ Assignment Submissions</h2>

  <table class="table table-striped table-hover mt-3">
    <thead>
      <tr>
        <th>Student</th>
        <th>Assignment</th>
        <th>Submitted At</th>
        <th>Grade</th>
        <th>File</th>
      </tr>
    </thead>
    <tbody>
      {% for submission in submissions %}
      <tr>
        <td>{{ submission.student.get_full_name }}</td>
        <td>{{ submission.assignment.title }}</td>
        <td>{{ submission.submitted_at|date:"SHORT_DATETIME_FORMAT" }}</td>
        <td>{{ submission.grade|default:"Not graded" }}</td>
        <td>
          {% if submission.submitted_file %}
            <a href="{{ submission.submitted_file.url }}" target="_blank" class="btn btn-sm btn-outline-primary">Download</a>
          {% else %}
            -
          {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="5" class="text-center">No submissions found.</td></tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Pagination controls -->
  {% if submissions.has_other_pages %}
  <nav aria-label="Submissions pagination">
    <ul class="pagination justify-content-center">
      {% if submissions.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?page={{ submissions.previous_page_number }}" aria-label="Previous">
          <span aria-hidden="true">&laquo;</span>
        </a>
      </li>
      {% else %}
      <li class="page-item disabled">
        <span class="page-link">&laquo;</span>
      </li>
      {% endif %}

      {% for num in submissions.paginator.page_range %}
        {% if submissions.number == num %}
          <li class="page-item active" aria-current="page"><span class="page-link">{{ num }}</span></li>
        {% elif num > submissions.number|add:'-3' and num < submissions.number|add:'3' %}
          <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
        {% endif %}
      {% endfor %}

      {% if submissions.has_next %}
      <li class="page-item">
        <a class="page-link" href="?page={{ submissions.next_page_number }}" aria-label="Next">
          <span aria-hidden="true">&raquo;</span>
        </a>
      </li>
      {% else %}
      <li class="page-item disabled">
        <span class="page-link">&raquo;</span>
      </li>
      {% endif %}
    </ul>
  </nav>
  {% endif %}
</div>
{% endblock %}
